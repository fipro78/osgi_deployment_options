<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd">
  <modelVersion>4.0.0</modelVersion>
  <parent>
    <groupId>org.fipro.service</groupId>
    <artifactId>service-application</artifactId>
    <version>1.0.0-SNAPSHOT</version>
  </parent>

  <groupId>org.fipro.osgi</groupId>
  <artifactId>benchmark.app</artifactId>

  <properties>
    <benchmark.alias>benchmark_service</benchmark.alias>
    <benchmark.port>8080</benchmark.port>
    <container.timeout>200000</container.timeout>
    <benchmark.iteration_count>10</benchmark.iteration_count>
    <benchmark.container.engine>docker</benchmark.container.engine>
  </properties>

  <dependencies>

    <!--  The OSGi framework RI is Equinox  -->
    <dependency>
      <groupId>org.eclipse.platform</groupId>
      <artifactId>org.eclipse.osgi</artifactId>
    </dependency>

    <!--  Declarative Services  -->
    <dependency>
      <groupId>org.osgi</groupId>
      <artifactId>org.osgi.service.component</artifactId>
    </dependency>
    <dependency>
      <groupId>org.apache.felix</groupId>
      <artifactId>org.apache.felix.scr</artifactId>
    </dependency>

    <!--  Configuration Admin  -->
    <dependency>
      <groupId>org.osgi</groupId>
      <artifactId>org.osgi.service.cm</artifactId>
      <scope>provided</scope>
    </dependency>
    <dependency>
      <groupId>org.apache.felix</groupId>
      <artifactId>org.apache.felix.configadmin</artifactId>
    </dependency>

    <!--  Metatype  -->
    <dependency>
      <groupId>org.eclipse.platform</groupId>
      <artifactId>org.eclipse.equinox.metatype</artifactId>
    </dependency>
    <dependency>
      <groupId>org.osgi</groupId>
      <artifactId>org.osgi.service.metatype</artifactId>
    </dependency>

    <!--  Event Admin  -->
    <dependency>
      <groupId>org.osgi</groupId>
      <artifactId>org.osgi.service.event</artifactId>
    </dependency>
    <dependency>
      <groupId>org.eclipse.platform</groupId>
      <artifactId>org.eclipse.equinox.event</artifactId>
    </dependency>

    <!--  Log Stream Service  -->
    <dependency>
      <groupId>org.osgi</groupId>
      <artifactId>org.osgi.service.log</artifactId>
    </dependency>
    <dependency>
      <groupId>org.eclipse.platform</groupId>
      <artifactId>org.eclipse.equinox.log.stream</artifactId>
    </dependency>

    <!--  Http Whiteboard  -->
    <dependency>
      <groupId>org.apache.felix</groupId>
      <artifactId>org.apache.felix.http.jetty</artifactId>
    </dependency>

    <!--  Http Servlet 3.1 API with contract  -->
    <dependency>
      <groupId>org.apache.felix</groupId>
      <artifactId>org.apache.felix.http.servlet-api</artifactId>
    </dependency>

    <!--  JAX-RS Whiteboard  -->
    <dependency>
      <groupId>org.osgi</groupId>
      <artifactId>org.osgi.service.jaxrs</artifactId>
    </dependency>
    <dependency>
      <groupId>org.apache.aries.jax.rs</groupId>
      <artifactId>org.apache.aries.jax.rs.whiteboard</artifactId>
    </dependency>

    <!--  JAX-RS 2.1 API with contract  -->
    <dependency>
      <groupId>org.apache.aries.spec</groupId>
      <artifactId>org.apache.aries.javax.jax.rs-api</artifactId>
    </dependency>

    <!--  JAX-RS Jackson  -->
    <dependency>
      <groupId>org.apache.aries.jax.rs</groupId>
      <artifactId>org.apache.aries.jax.rs.jackson</artifactId>
    </dependency>

    <!--  OSGi Function  -->
    <dependency>
      <groupId>org.osgi</groupId>
      <artifactId>org.osgi.util.function</artifactId>
    </dependency>
    <!--  OSGi Promise  -->
    <dependency>
      <groupId>org.osgi</groupId>
      <artifactId>org.osgi.util.promise</artifactId>
    </dependency>
    <!--  OSGi PushStream  -->
    <dependency>
      <groupId>org.osgi</groupId>
      <artifactId>org.osgi.util.pushstream</artifactId>
    </dependency>
    <!--  OSGi Converter  -->
    <dependency>
      <groupId>org.osgi</groupId>
      <artifactId>org.osgi.util.converter</artifactId>
    </dependency>
    <!--  OSGi Configurator  -->
    <dependency>
      <groupId>org.apache.felix</groupId>
      <artifactId>org.apache.felix.configurator</artifactId>
    </dependency>

    <!--  Several implementations need to log using SLF4J  -->
    <dependency>
      <groupId>org.slf4j</groupId>
      <artifactId>slf4j-api</artifactId>
    </dependency>
    <dependency>
      <groupId>ch.qos.logback</groupId>
      <artifactId>logback-classic</artifactId>
    </dependency>
    <dependency>
      <groupId>ch.qos.logback</groupId>
      <artifactId>logback-core</artifactId>
    </dependency>

    <!-- Java 11 XML -->
    <dependency>
      <groupId>com.sun.activation</groupId>
      <artifactId>jakarta.activation</artifactId>
    </dependency>
    <dependency>
      <groupId>com.sun.xml.bind</groupId>
      <artifactId>jaxb-osgi</artifactId>
    </dependency>
    <dependency>
      <groupId>jakarta.xml.bind</groupId>
      <artifactId>jakarta.xml.bind-api</artifactId>
    </dependency>
    <dependency>
      <groupId>jakarta.xml.ws</groupId>
      <artifactId>jakarta.xml.ws-api</artifactId>
    </dependency>

    <dependency>
      <groupId>org.apache.geronimo.specs</groupId>
      <artifactId>geronimo-json_1.1_spec</artifactId>
    </dependency>
    <dependency>
      <groupId>org.apache.geronimo.specs</groupId>
      <artifactId>geronimo-jaxrs_2.1_spec</artifactId>
    </dependency>

    <!--  The Web Console  -->
    <dependency>
      <groupId>org.apache.felix</groupId>
      <artifactId>org.apache.felix.webconsole</artifactId>
    </dependency>
    <dependency>
      <groupId>org.apache.felix</groupId>
      <artifactId>org.apache.felix.webconsole.plugins.ds</artifactId>
    </dependency>
    <dependency>
      <groupId>org.apache.felix</groupId>
      <artifactId>org.apache.felix.inventory</artifactId>
    </dependency>

    <!--  The Gogo Shell  -->
    <dependency>
      <groupId>org.apache.felix</groupId>
      <artifactId>org.apache.felix.gogo.shell</artifactId>
    </dependency>
    <dependency>
      <groupId>org.apache.felix</groupId>
      <artifactId>org.apache.felix.gogo.runtime</artifactId>
    </dependency>
    <dependency>
      <groupId>org.apache.felix</groupId>
      <artifactId>org.apache.felix.gogo.command</artifactId>
    </dependency>

    <dependency>
      <groupId>org.fipro.osgi</groupId>
      <artifactId>benchmark.service</artifactId>
      <version>${project.version}</version>
    </dependency>
  </dependencies>

  <build>
    <plugins>
      <plugin>
        <groupId>biz.aQute.bnd</groupId>
        <artifactId>bnd-maven-plugin</artifactId>
      </plugin>
      <plugin>
        <groupId>biz.aQute.bnd</groupId>
        <artifactId>bnd-indexer-maven-plugin</artifactId>
        <configuration>
          <includeJar>true</includeJar>
        </configuration>
      </plugin>
      <plugin>
        <groupId>biz.aQute.bnd</groupId>
        <artifactId>bnd-export-maven-plugin</artifactId>
        <configuration>
          <bndruns>
            <bndrun>app.bndrun</bndrun>
          </bndruns>
        </configuration>
      </plugin>
      <plugin>
        <groupId>biz.aQute.bnd</groupId>
        <artifactId>bnd-resolver-maven-plugin</artifactId>
        <configuration>
          <bndruns>
            <bndrun>app.bndrun</bndrun>
          </bndruns>
        </configuration>
      </plugin>
      <plugin>
        <artifactId>maven-resources-plugin</artifactId>
        <version>3.3.0</version>
        <executions>
          <execution>
            <id>copy-executable</id>
            <phase>package</phase>
            <goals>
              <goal>copy-resources</goal>
            </goals>
            <configuration>
              <outputDirectory>${project.build.directory}/app</outputDirectory>
              <resources>          
                <resource>
                  <directory>${project.build.directory}</directory>
                  <includes>
                    <include>app.jar</include>
                  </includes>
                </resource>
              </resources>              
            </configuration>
          </execution>
        </executions>
      </plugin>
      <plugin>
        <groupId>io.fabric8</groupId>
        <artifactId>docker-maven-plugin</artifactId>
        <extensions>true</extensions>
        <configuration>
          <autoCreateCustomNetworks>true</autoCreateCustomNetworks>
          <images>
            <image>
              <name>osgi-benchmark-app:17_temurin</name>
              <alias>${benchmark.alias}</alias>

              <build>
                <dockerFile>${project.basedir}/src/main/docker/Dockerfile</dockerFile>
                <contextDir>${project.build.directory}/app</contextDir>
                <args>
                  <EXECUTABLE_JAR>app.jar</EXECUTABLE_JAR>
                </args>
              </build>

              <run>
                <network>
                  <mode>custom</mode>
                  <name>benchmark_network</name>
                </network>
                <ports>
                  <port>benchmark.port:8080</port>
                </ports>
                <wait>
                  <http>
                    <url>http://127.0.0.1:${benchmark.port}/benchmark/details</url>
                  </http>
                  <time>10000</time>
                </wait>
              </run>
            </image>
          </images>
          
          <!-- use the image alias as container name on start -->
          <containerNamePattern>%a</containerNamePattern>
        </configuration>

        <!-- Connect start/stop to pre- and
             post-integration-test phase, respectively if you want to start
             your docker containers during integration tests -->
        <executions>
          <execution>
            <id>start</id>
            <phase>pre-integration-test</phase>
            <goals>
              <!-- "build" is used to create the images with the artifact -->
              <goal>build</goal>
              <goal>start</goal>
            </goals>
          </execution>
          <execution>
            <id>stop</id>
            <phase>post-integration-test</phase>
            <goals>
              <goal>stop</goal>
            </goals>
          </execution>
        </executions>
      </plugin>
    </plugins>
  </build>

  <profiles>
    <profile>
      <id>kill</id>
      <build>
        <plugins>
          <plugin>
            <groupId>io.fabric8</groupId>
            <artifactId>docker-maven-plugin</artifactId>
            <extensions>true</extensions>
            <configuration>
              <!-- stop all benchmark containers created by a previous run with -Ddocker.keepRunning=true -->
              <stopNamePattern>benchmark_**</stopNamePattern>
              <!-- override the image configuration to avoid that the ${benchmark.alias} container is started again -->
              <images combine.self="override">
              </images>
            </configuration>
    
            <executions>
              <execution>
                <id>stop</id>
                <phase>clean</phase>
                <goals>
                  <goal>stop</goal>
                </goals>
              </execution>
            </executions>
          </plugin>
        </plugins>
      </build>
    </profile>

    <profile>
      <id>temurin_21</id>
      <build>
        <plugins>
          <plugin>
            <groupId>io.fabric8</groupId>
            <artifactId>docker-maven-plugin</artifactId>
            <extensions>true</extensions>
            <configuration>
              <images combine.children="append">
                <image>
                  <name>osgi-deployment-folder-app:21_temurin</name>
                  <alias>benchmark_folder_21</alias>
                  
                  <run>
                    <dependsOn>
                      <container>${benchmark.alias}</container>
                    </dependsOn>
                    <network>
                      <mode>custom</mode>
                      <name>benchmark_network</name>
                    </network>
                    <env>
                      <BENCHMARK_SERVICE_HOST>${benchmark.alias}</BENCHMARK_SERVICE_HOST>
                      <BENCHMARK_SUFFIX>_JAVA21</BENCHMARK_SUFFIX>
                      <ITERATION_COUNT>${benchmark.iteration_count}</ITERATION_COUNT>
                    </env>
                    <cmd>./start_benchmark.sh</cmd>
                    <wait>
                      <time>${container.timeout}</time>
                      <exit>0</exit>
                    </wait>
                  </run>
                </image>
                <image>
                  <name>osgi-deployment-executable-app:21_temurin</name>
                  <alias>benchmark_executable_21</alias>
                  
                  <run>
                    <dependsOn>
                      <container>benchmark_folder_21</container>
                    </dependsOn>
                    <network>
                      <mode>custom</mode>
                      <name>benchmark_network</name>
                    </network>
                    <env>
                      <BENCHMARK_SERVICE_HOST>${benchmark.alias}</BENCHMARK_SERVICE_HOST>
                      <BENCHMARK_SUFFIX>_JAVA21</BENCHMARK_SUFFIX>
                      <ITERATION_COUNT>${benchmark.iteration_count}</ITERATION_COUNT>
                    </env>
                    <cmd>./start_benchmark.sh</cmd>
                    <wait>
                      <time>${container.timeout}</time>
                      <exit>0</exit>
                    </wait>
                  </run>
                </image>
                <image>
                  <name>osgi-deployment-jlink-app:21_temurin</name>
                  <alias>benchmark_jlink_21</alias>
                  
                  <run>
                    <dependsOn>
                      <container>benchmark_executable_21</container>
                    </dependsOn>
                    <network>
                      <mode>custom</mode>
                      <name>benchmark_network</name>
                    </network>
                    <env>
                      <BENCHMARK_SERVICE_HOST>${benchmark.alias}</BENCHMARK_SERVICE_HOST>
                      <BENCHMARK_SUFFIX>_JAVA21</BENCHMARK_SUFFIX>
                      <ITERATION_COUNT>${benchmark.iteration_count}</ITERATION_COUNT>
                    </env>
                    <cmd>/app/bin/start_benchmark.sh</cmd>
                    <wait>
                      <time>${container.timeout}</time>
                      <exit>0</exit>
                    </wait>
                  </run>
                </image>
                <image>
                  <name>osgi-deployment-jlink-compressed-app:21_temurin</name>
                  <alias>benchmark_jlink_compressed_21</alias>
                  
                  <run>
                    <dependsOn>
                      <container>benchmark_jlink_21</container>
                    </dependsOn>
                    <network>
                      <mode>custom</mode>
                      <name>benchmark_network</name>
                    </network>
                    <env>
                      <BENCHMARK_SERVICE_HOST>${benchmark.alias}</BENCHMARK_SERVICE_HOST>
                      <BENCHMARK_SUFFIX>_JAVA21</BENCHMARK_SUFFIX>
                      <ITERATION_COUNT>${benchmark.iteration_count}</ITERATION_COUNT>
                    </env>
                    <cmd>/app/bin/start_benchmark.sh</cmd>
                    <wait>
                      <time>${container.timeout}</time>
                      <exit>0</exit>
                    </wait>
                  </run>
                </image>
                <image>
                  <name>osgi-deployment-folder-atomos-app:21_temurin</name>
                  <alias>benchmark_folder_atomos_21</alias>
                  
                  <run>
                    <dependsOn>
                      <container>benchmark_jlink_compressed_21</container>
                    </dependsOn>
                    <network>
                      <mode>custom</mode>
                      <name>benchmark_network</name>
                    </network>
                    <env>
                      <BENCHMARK_SERVICE_HOST>${benchmark.alias}</BENCHMARK_SERVICE_HOST>
                      <BENCHMARK_SUFFIX>_JAVA21</BENCHMARK_SUFFIX>
                      <ITERATION_COUNT>${benchmark.iteration_count}</ITERATION_COUNT>
                    </env>
                    <cmd>./start_benchmark.sh</cmd>
                    <wait>
                      <time>${container.timeout}</time>
                      <exit>0</exit>
                    </wait>
                  </run>
                </image>
                <image>
                  <name>osgi-deployment-jlink-atomos-app:21_temurin</name>
                  <alias>benchmark_jlink_atomos_21</alias>
                  
                  <run>
                    <dependsOn>
                      <container>benchmark_folder_atomos_21</container>
                    </dependsOn>
                    <network>
                      <mode>custom</mode>
                      <name>benchmark_network</name>
                    </network>
                    <env>
                      <BENCHMARK_SERVICE_HOST>${benchmark.alias}</BENCHMARK_SERVICE_HOST>
                      <BENCHMARK_SUFFIX>_JAVA21</BENCHMARK_SUFFIX>
                      <ITERATION_COUNT>${benchmark.iteration_count}</ITERATION_COUNT>
                    </env>
                    <cmd>/app/bin/start_benchmark.sh</cmd>
                    <wait>
                      <time>${container.timeout}</time>
                      <exit>0</exit>
                    </wait>
                  </run>
                </image>
                <image>
                  <name>osgi-deployment-jlink-atomos-compressed-app:21_temurin</name>
                  <alias>benchmark_jlink_atomos_compressed_21</alias>
                  
                  <run>
                    <dependsOn>
                      <container>benchmark_jlink_atomos_21</container>
                    </dependsOn>
                    <network>
                      <mode>custom</mode>
                      <name>benchmark_network</name>
                    </network>
                    <env>
                      <BENCHMARK_SERVICE_HOST>${benchmark.alias}</BENCHMARK_SERVICE_HOST>
                      <BENCHMARK_SUFFIX>_JAVA21</BENCHMARK_SUFFIX>
                      <ITERATION_COUNT>${benchmark.iteration_count}</ITERATION_COUNT>
                    </env>
                    <cmd>/app/bin/start_benchmark.sh</cmd>
                    <wait>
                      <time>${container.timeout}</time>
                      <exit>0</exit>
                    </wait>
                  </run>
                </image>
                <!--
                -->
              </images>
            </configuration>
          </plugin>
        </plugins>
      </build>
    </profile>
    <profile>
      <id>temurin_17</id>
      <activation>
        <activeByDefault>true</activeByDefault>
      </activation>
      <build>
        <plugins>
          <plugin>
            <groupId>io.fabric8</groupId>
            <artifactId>docker-maven-plugin</artifactId>
            <extensions>true</extensions>
            <configuration>
              <images combine.children="append">
                <image>
                  <name>osgi-deployment-folder-app:17_temurin</name>
                  <alias>benchmark_folder_17</alias>
                  
                  <run>
                    <dependsOn>
                      <container>${benchmark.alias}</container>
                    </dependsOn>
                    <network>
                      <mode>custom</mode>
                      <name>benchmark_network</name>
                    </network>
                    <env>
                      <BENCHMARK_SERVICE_HOST>${benchmark.alias}</BENCHMARK_SERVICE_HOST>
                      <ITERATION_COUNT>${benchmark.iteration_count}</ITERATION_COUNT>
                    </env>
                    <cmd>./start_benchmark.sh</cmd>
                    <wait>
                      <time>${container.timeout}</time>
                      <exit>0</exit>
                    </wait>
                  </run>
                </image>
                <image>
                  <name>osgi-deployment-executable-app:17_temurin</name>
                  <alias>benchmark_executable_17</alias>
                  
                  <run>
                    <dependsOn>
                      <container>benchmark_folder_17</container>
                    </dependsOn>
                    <network>
                      <mode>custom</mode>
                      <name>benchmark_network</name>
                    </network>
                    <env>
                      <BENCHMARK_SERVICE_HOST>${benchmark.alias}</BENCHMARK_SERVICE_HOST>
                      <ITERATION_COUNT>${benchmark.iteration_count}</ITERATION_COUNT>
                    </env>
                    <cmd>./start_benchmark.sh</cmd>
                    <wait>
                      <time>${container.timeout}</time>
                      <exit>0</exit>
                    </wait>
                  </run>
                </image>
                <image>
                  <name>osgi-deployment-jlink-app:17_temurin</name>
                  <alias>benchmark_jlink_17</alias>
                  
                  <run>
                    <dependsOn>
                      <container>benchmark_executable_17</container>
                    </dependsOn>
                    <network>
                      <mode>custom</mode>
                      <name>benchmark_network</name>
                    </network>
                    <env>
                      <BENCHMARK_SERVICE_HOST>${benchmark.alias}</BENCHMARK_SERVICE_HOST>
                      <ITERATION_COUNT>${benchmark.iteration_count}</ITERATION_COUNT>
                    </env>
                    <cmd>/app/bin/start_benchmark.sh</cmd>
                    <wait>
                      <time>${container.timeout}</time>
                      <exit>0</exit>
                    </wait>
                  </run>
                </image>
                <image>
                  <name>osgi-deployment-jlink-compressed-app:17_temurin</name>
                  <alias>benchmark_jlink_compressed_17</alias>
                  
                  <run>
                    <dependsOn>
                      <container>benchmark_jlink_17</container>
                    </dependsOn>
                    <network>
                      <mode>custom</mode>
                      <name>benchmark_network</name>
                    </network>
                    <env>
                      <BENCHMARK_SERVICE_HOST>${benchmark.alias}</BENCHMARK_SERVICE_HOST>
                      <ITERATION_COUNT>${benchmark.iteration_count}</ITERATION_COUNT>
                    </env>
                    <cmd>/app/bin/start_benchmark.sh</cmd>
                    <wait>
                      <time>${container.timeout}</time>
                      <exit>0</exit>
                    </wait>
                  </run>
                </image>
                <image>
                  <name>osgi-deployment-folder-atomos-app:17_temurin</name>
                  <alias>benchmark_folder_atomos_17</alias>
                  
                  <run>
                    <dependsOn>
                      <container>benchmark_jlink_compressed_17</container>
                    </dependsOn>
                    <network>
                      <mode>custom</mode>
                      <name>benchmark_network</name>
                    </network>
                    <env>
                      <BENCHMARK_SERVICE_HOST>${benchmark.alias}</BENCHMARK_SERVICE_HOST>
                      <ITERATION_COUNT>${benchmark.iteration_count}</ITERATION_COUNT>
                    </env>
                    <cmd>./start_benchmark.sh</cmd>
                    <wait>
                      <time>${container.timeout}</time>
                      <exit>0</exit>
                    </wait>
                  </run>
                </image>
                <image>
                  <name>osgi-deployment-jlink-atomos-app:17_temurin</name>
                  <alias>benchmark_jlink_atomos_17</alias>
                  
                  <run>
                    <dependsOn>
                      <container>benchmark_folder_atomos_17</container>
                    </dependsOn>
                    <network>
                      <mode>custom</mode>
                      <name>benchmark_network</name>
                    </network>
                    <env>
                      <BENCHMARK_SERVICE_HOST>${benchmark.alias}</BENCHMARK_SERVICE_HOST>
                      <ITERATION_COUNT>${benchmark.iteration_count}</ITERATION_COUNT>
                    </env>
                    <cmd>/app/bin/start_benchmark.sh</cmd>
                    <wait>
                      <time>${container.timeout}</time>
                      <exit>0</exit>
                    </wait>
                  </run>
                </image>
                <image>
                  <name>osgi-deployment-jlink-atomos-compressed-app:17_temurin</name>
                  <alias>benchmark_jlink_atomos_compressed_17</alias>
                  
                  <run>
                    <dependsOn>
                      <container>benchmark_jlink_atomos_17</container>
                    </dependsOn>
                    <network>
                      <mode>custom</mode>
                      <name>benchmark_network</name>
                    </network>
                    <env>
                      <BENCHMARK_SERVICE_HOST>${benchmark.alias}</BENCHMARK_SERVICE_HOST>
                      <ITERATION_COUNT>${benchmark.iteration_count}</ITERATION_COUNT>
                    </env>
                    <cmd>/app/bin/start_benchmark.sh</cmd>
                    <wait>
                      <time>${container.timeout}</time>
                      <exit>0</exit>
                    </wait>
                  </run>
                </image>
                <!--
                -->
              </images>
            </configuration>
          </plugin>
        </plugins>
      </build>
    </profile>
    <profile>
      <id>temurin_11</id>
      <build>
        <plugins>
          <plugin>
            <groupId>io.fabric8</groupId>
            <artifactId>docker-maven-plugin</artifactId>
            <extensions>true</extensions>
            <configuration>
              <images combine.children="append">
                <image>
                  <name>osgi-deployment-folder-app:11_temurin</name>
                  <alias>benchmark_folder_11</alias>
                  
                  <run>
                    <dependsOn>
                      <container>${benchmark.alias}</container>
                    </dependsOn>
                    <network>
                      <mode>custom</mode>
                      <name>benchmark_network</name>
                    </network>
                    <env>
                      <BENCHMARK_SERVICE_HOST>${benchmark.alias}</BENCHMARK_SERVICE_HOST>
                      <BENCHMARK_SUFFIX>_JAVA11</BENCHMARK_SUFFIX>
                      <ITERATION_COUNT>${benchmark.iteration_count}</ITERATION_COUNT>
                    </env>
                    <cmd>./start_benchmark.sh</cmd>
                    <wait>
                      <time>${container.timeout}</time>
                      <exit>0</exit>
                    </wait>
                  </run>
                </image>
                <image>
                  <name>osgi-deployment-executable-app:11_temurin</name>
                  <alias>benchmark_executable_11</alias>
                  
                  <run>
                    <dependsOn>
                      <container>benchmark_folder_11</container>
                    </dependsOn>
                    <network>
                      <mode>custom</mode>
                      <name>benchmark_network</name>
                    </network>
                    <env>
                      <BENCHMARK_SERVICE_HOST>${benchmark.alias}</BENCHMARK_SERVICE_HOST>
                      <BENCHMARK_SUFFIX>_JAVA11</BENCHMARK_SUFFIX>
                      <ITERATION_COUNT>${benchmark.iteration_count}</ITERATION_COUNT>
                    </env>
                    <cmd>./start_benchmark.sh</cmd>
                    <wait>
                      <time>${container.timeout}</time>
                      <exit>0</exit>
                    </wait>
                  </run>
                </image>
                <image>
                  <name>osgi-deployment-jlink-app:11_temurin</name>
                  <alias>benchmark_jlink_11</alias>
                  
                  <run>
                    <dependsOn>
                      <container>benchmark_executable_11</container>
                    </dependsOn>
                    <network>
                      <mode>custom</mode>
                      <name>benchmark_network</name>
                    </network>
                    <env>
                      <BENCHMARK_SERVICE_HOST>${benchmark.alias}</BENCHMARK_SERVICE_HOST>
                      <BENCHMARK_SUFFIX>_JAVA11</BENCHMARK_SUFFIX>
                      <ITERATION_COUNT>${benchmark.iteration_count}</ITERATION_COUNT>
                    </env>
                    <cmd>/app/bin/start_benchmark.sh</cmd>
                    <wait>
                      <time>${container.timeout}</time>
                      <exit>0</exit>
                    </wait>
                  </run>
                </image>
                <image>
                  <name>osgi-deployment-jlink-compressed-app:11_temurin</name>
                  <alias>benchmark_jlink_compressed_11</alias>
                  
                  <run>
                    <dependsOn>
                      <container>benchmark_jlink_11</container>
                    </dependsOn>
                    <network>
                      <mode>custom</mode>
                      <name>benchmark_network</name>
                    </network>
                    <env>
                      <BENCHMARK_SERVICE_HOST>${benchmark.alias}</BENCHMARK_SERVICE_HOST>
                      <BENCHMARK_SUFFIX>_JAVA11</BENCHMARK_SUFFIX>
                      <ITERATION_COUNT>${benchmark.iteration_count}</ITERATION_COUNT>
                    </env>
                    <cmd>/app/bin/start_benchmark.sh</cmd>
                    <wait>
                      <time>${container.timeout}</time>
                      <exit>0</exit>
                    </wait>
                  </run>
                </image>
                <image>
                  <name>osgi-deployment-folder-atomos-app:11_temurin</name>
                  <alias>benchmark_folder_atomos_11</alias>
                  
                  <run>
                    <dependsOn>
                      <container>benchmark_jlink_compressed_11</container>
                    </dependsOn>
                    <network>
                      <mode>custom</mode>
                      <name>benchmark_network</name>
                    </network>
                    <env>
                      <BENCHMARK_SERVICE_HOST>${benchmark.alias}</BENCHMARK_SERVICE_HOST>
                      <BENCHMARK_SUFFIX>_JAVA11</BENCHMARK_SUFFIX>
                      <ITERATION_COUNT>${benchmark.iteration_count}</ITERATION_COUNT>
                    </env>
                    <cmd>./start_benchmark.sh</cmd>
                    <wait>
                      <time>${container.timeout}</time>
                      <exit>0</exit>
                    </wait>
                  </run>
                </image>
                <image>
                  <name>osgi-deployment-jlink-atomos-app:11_temurin</name>
                  <alias>benchmark_jlink_atomos_11</alias>
                  
                  <run>
                    <dependsOn>
                      <container>benchmark_folder_atomos_11</container>
                    </dependsOn>
                    <network>
                      <mode>custom</mode>
                      <name>benchmark_network</name>
                    </network>
                    <env>
                      <BENCHMARK_SERVICE_HOST>${benchmark.alias}</BENCHMARK_SERVICE_HOST>
                      <BENCHMARK_SUFFIX>_JAVA11</BENCHMARK_SUFFIX>
                      <ITERATION_COUNT>${benchmark.iteration_count}</ITERATION_COUNT>
                    </env>
                    <cmd>/app/bin/start_benchmark.sh</cmd>
                    <wait>
                      <time>${container.timeout}</time>
                      <exit>0</exit>
                    </wait>
                  </run>
                </image>
                <image>
                  <name>osgi-deployment-jlink-atomos-compressed-app:11_temurin</name>
                  <alias>benchmark_jlink_atomos_compressed_11</alias>
                  
                  <run>
                    <dependsOn>
                      <container>benchmark_jlink_atomos_11</container>
                    </dependsOn>
                    <network>
                      <mode>custom</mode>
                      <name>benchmark_network</name>
                    </network>
                    <env>
                      <BENCHMARK_SERVICE_HOST>${benchmark.alias}</BENCHMARK_SERVICE_HOST>
                      <BENCHMARK_SUFFIX>_JAVA11</BENCHMARK_SUFFIX>
                      <ITERATION_COUNT>${benchmark.iteration_count}</ITERATION_COUNT>
                    </env>
                    <cmd>/app/bin/start_benchmark.sh</cmd>
                    <wait>
                      <time>${container.timeout}</time>
                      <exit>0</exit>
                    </wait>
                  </run>
                </image>
                <!--
                -->
              </images>
            </configuration>
          </plugin>
        </plugins>
      </build>
    </profile>
    <profile>
      <id>graalvm_17</id>
      <build>
        <plugins>
          <plugin>
            <groupId>io.fabric8</groupId>
            <artifactId>docker-maven-plugin</artifactId>
            <extensions>true</extensions>
            <configuration>
              <images combine.children="append">
                <image>
                  <name>osgi-deployment-graalvm:17-alpine</name>
                  <alias>benchmark_graalvm_atomos_17</alias>
                  
                  <run>
                    <dependsOn>
                      <container>${benchmark.alias}</container>
                    </dependsOn>
                    <network>
                      <mode>custom</mode>
                      <name>benchmark_network</name>
                    </network>
                    <env>
                      <BENCHMARK_SERVICE_HOST>${benchmark.alias}</BENCHMARK_SERVICE_HOST>
                      <BENCHMARK_SUFFIX>_17</BENCHMARK_SUFFIX>
                      <ITERATION_COUNT>${benchmark.iteration_count}</ITERATION_COUNT>
                    </env>
                    <cmd>/app/start_benchmark.sh</cmd>
                    <wait>
                      <time>${container.timeout}</time>
                      <exit>0</exit>
                    </wait>
                  </run>
                </image>
              </images>
            </configuration>
          </plugin>
        </plugins>
      </build>
    </profile>
    <profile>
      <id>graalvm_21</id>
      <build>
        <plugins>
          <plugin>
            <groupId>io.fabric8</groupId>
            <artifactId>docker-maven-plugin</artifactId>
            <extensions>true</extensions>
            <configuration>
              <images combine.children="append">
                <image>
                  <name>osgi-deployment-graalvm:21-alpine</name>
                  <alias>benchmark_graalvm_atomos_21</alias>
                  
                  <run>
                    <dependsOn>
                      <container>${benchmark.alias}</container>
                    </dependsOn>
                    <network>
                      <mode>custom</mode>
                      <name>benchmark_network</name>
                    </network>
                    <env>
                      <BENCHMARK_SERVICE_HOST>${benchmark.alias}</BENCHMARK_SERVICE_HOST>
                      <BENCHMARK_SUFFIX>_21</BENCHMARK_SUFFIX>
                      <ITERATION_COUNT>${benchmark.iteration_count}</ITERATION_COUNT>
                    </env>
                    <cmd>/app/start_benchmark.sh</cmd>
                    <wait>
                      <time>${container.timeout}</time>
                      <exit>0</exit>
                    </wait>
                  </run>
                </image>
              </images>
            </configuration>
          </plugin>
        </plugins>
      </build>
    </profile>
    <profile>
      <id>graalvm_ce_17</id>
      <build>
        <plugins>
          <plugin>
            <groupId>io.fabric8</groupId>
            <artifactId>docker-maven-plugin</artifactId>
            <extensions>true</extensions>
            <configuration>
              <images combine.children="append">
                <image>
                  <name>osgi-deployment-graalvm-ce:17-alpine</name>
                  <alias>benchmark_graalvm_ce_atomos_17</alias>
                  
                  <run>
                    <dependsOn>
                      <container>${benchmark.alias}</container>
                    </dependsOn>
                    <network>
                      <mode>custom</mode>
                      <name>benchmark_network</name>
                    </network>
                    <env>
                      <BENCHMARK_SERVICE_HOST>${benchmark.alias}</BENCHMARK_SERVICE_HOST>
                      <BENCHMARK_SUFFIX>_CE_17</BENCHMARK_SUFFIX>
                      <ITERATION_COUNT>${benchmark.iteration_count}</ITERATION_COUNT>
                    </env>
                    <cmd>/app/start_benchmark.sh</cmd>
                    <wait>
                      <time>${container.timeout}</time>
                      <exit>0</exit>
                    </wait>
                  </run>
                </image>
              </images>
            </configuration>
          </plugin>
        </plugins>
      </build>
    </profile>
    <profile>
      <id>graalvm_ce_21</id>
      <build>
        <plugins>
          <plugin>
            <groupId>io.fabric8</groupId>
            <artifactId>docker-maven-plugin</artifactId>
            <extensions>true</extensions>
            <configuration>
              <images combine.children="append">
                <image>
                  <name>osgi-deployment-graalvm-ce:21-alpine</name>
                  <alias>benchmark_graalvm_ce_atomos_21</alias>
                  
                  <run>
                    <dependsOn>
                      <container>${benchmark.alias}</container>
                    </dependsOn>
                    <network>
                      <mode>custom</mode>
                      <name>benchmark_network</name>
                    </network>
                    <env>
                      <BENCHMARK_SERVICE_HOST>${benchmark.alias}</BENCHMARK_SERVICE_HOST>
                      <BENCHMARK_SUFFIX>_CE_21</BENCHMARK_SUFFIX>
                      <ITERATION_COUNT>${benchmark.iteration_count}</ITERATION_COUNT>
                    </env>
                    <cmd>/app/start_benchmark.sh</cmd>
                    <wait>
                      <time>${container.timeout}</time>
                      <exit>0</exit>
                    </wait>
                  </run>
                </image>
              </images>
            </configuration>
          </plugin>
        </plugins>
      </build>
    </profile>
    <profile>
      <id>semeru_17</id>
      <build>
        <plugins>
          <plugin>
            <groupId>io.fabric8</groupId>
            <artifactId>docker-maven-plugin</artifactId>
            <extensions>true</extensions>
            <configuration>
              <images combine.children="append">
                <!--
                -->
                <image>
                  <name>osgi-deployment-folder-app:17_openj9</name>
                  <alias>benchmark_folder_17_openj9</alias>
                  
                  <run>
                    <dependsOn>
                      <container>${benchmark.alias}</container>
                    </dependsOn>
                    <network>
                      <mode>custom</mode>
                      <name>benchmark_network</name>
                    </network>
                    <env>
                      <BENCHMARK_SERVICE_HOST>${benchmark.alias}</BENCHMARK_SERVICE_HOST>
                      <BENCHMARK_SUFFIX>_OPENJ9</BENCHMARK_SUFFIX>
                      <ITERATION_COUNT>${benchmark.iteration_count}</ITERATION_COUNT>
                    </env>
                    <cmd>./start_benchmark.sh</cmd>
                    <wait>
                      <time>${container.timeout}</time>
                      <exit>0</exit>
                    </wait>
                  </run>
                </image>
                <image>
                  <name>osgi-deployment-executable-app:17_openj9</name>
                  <alias>benchmark_executable_17_openj9</alias>
                  
                  <run>
                    <dependsOn>
                      <container>benchmark_folder_17_openj9</container>
                    </dependsOn>
                    <network>
                      <mode>custom</mode>
                      <name>benchmark_network</name>
                    </network>
                    <env>
                      <BENCHMARK_SERVICE_HOST>${benchmark.alias}</BENCHMARK_SERVICE_HOST>
                      <BENCHMARK_SUFFIX>_OPENJ9</BENCHMARK_SUFFIX>
                      <ITERATION_COUNT>${benchmark.iteration_count}</ITERATION_COUNT>
                    </env>
                    <cmd>./start_benchmark.sh</cmd>
                    <wait>
                      <time>${container.timeout}</time>
                      <exit>0</exit>
                    </wait>
                  </run>
                </image>
                <image>
                  <name>osgi-deployment-jlink-app:17_openj9</name>
                  <alias>benchmark_jlink_17</alias>
                  
                  <run>
                    <dependsOn>
                      <container>benchmark_executable_17_openj9</container>
                    </dependsOn>
                    <network>
                      <mode>custom</mode>
                      <name>benchmark_network</name>
                    </network>
                    <env>
                      <BENCHMARK_SERVICE_HOST>${benchmark.alias}</BENCHMARK_SERVICE_HOST>
                      <BENCHMARK_SUFFIX>_OPENJ9</BENCHMARK_SUFFIX>
                      <ITERATION_COUNT>${benchmark.iteration_count}</ITERATION_COUNT>
                    </env>
                    <cmd>/app/bin/start_benchmark.sh</cmd>
                    <wait>
                      <time>${container.timeout}</time>
                      <exit>0</exit>
                    </wait>
                  </run>
                </image>
                <image>
                  <name>osgi-deployment-jlink-compressed-app:17_openj9</name>
                  <alias>benchmark_jlink_compressed_17_openj9</alias>
                  
                  <run>
                    <dependsOn>
                      <container>benchmark_jlink_17_openj9</container>
                    </dependsOn>
                    <network>
                      <mode>custom</mode>
                      <name>benchmark_network</name>
                    </network>
                    <env>
                      <BENCHMARK_SERVICE_HOST>${benchmark.alias}</BENCHMARK_SERVICE_HOST>
                      <BENCHMARK_SUFFIX>_OPENJ9</BENCHMARK_SUFFIX>
                      <ITERATION_COUNT>${benchmark.iteration_count}</ITERATION_COUNT>
                    </env>
                    <cmd>/app/bin/start_benchmark.sh</cmd>
                    <wait>
                      <time>${container.timeout}</time>
                      <exit>0</exit>
                    </wait>
                  </run>
                </image>
                <image>
                  <name>osgi-deployment-folder-atomos-app:17_openj9</name>
                  <alias>benchmark_folder_atomos_17_openj9</alias>
                  
                  <run>
                    <dependsOn>
                      <container>benchmark_jlink_compressed_17_openj9</container>
                    </dependsOn>
                    <network>
                      <mode>custom</mode>
                      <name>benchmark_network</name>
                    </network>
                    <env>
                      <BENCHMARK_SERVICE_HOST>${benchmark.alias}</BENCHMARK_SERVICE_HOST>
                      <BENCHMARK_SUFFIX>_OPENJ9</BENCHMARK_SUFFIX>
                      <ITERATION_COUNT>${benchmark.iteration_count}</ITERATION_COUNT>
                    </env>
                    <cmd>./start_benchmark.sh</cmd>
                    <wait>
                      <time>${container.timeout}</time>
                      <exit>0</exit>
                    </wait>
                  </run>
                </image>
                <image>
                  <name>osgi-deployment-jlink-atomos-app:17_openj9</name>
                  <alias>benchmark_jlink_atomos_17_openj9</alias>
                  
                  <run>
                    <dependsOn>
                      <container>benchmark_folder_atomos_17_openj9</container>
                    </dependsOn>
                    <network>
                      <mode>custom</mode>
                      <name>benchmark_network</name>
                    </network>
                    <env>
                      <BENCHMARK_SERVICE_HOST>${benchmark.alias}</BENCHMARK_SERVICE_HOST>
                      <BENCHMARK_SUFFIX>_OPENJ9</BENCHMARK_SUFFIX>
                      <ITERATION_COUNT>${benchmark.iteration_count}</ITERATION_COUNT>
                    </env>
                    <cmd>/app/bin/start_benchmark.sh</cmd>
                    <wait>
                      <time>${container.timeout}</time>
                      <exit>0</exit>
                    </wait>
                  </run>
                </image>
                <image>
                  <name>osgi-deployment-jlink-atomos-compressed-app:17_openj9</name>
                  <alias>benchmark_jlink_atomos_compressed_17_openj9</alias>
                  
                  <run>
                    <dependsOn>
                      <container>benchmark_jlink_atomos_17_openj9</container>
                    </dependsOn>
                    <network>
                      <mode>custom</mode>
                      <name>benchmark_network</name>
                    </network>
                    <env>
                      <BENCHMARK_SERVICE_HOST>${benchmark.alias}</BENCHMARK_SERVICE_HOST>
                      <BENCHMARK_SUFFIX>_OPENJ9</BENCHMARK_SUFFIX>
                      <ITERATION_COUNT>${benchmark.iteration_count}</ITERATION_COUNT>
                    </env>
                    <cmd>/app/bin/start_benchmark.sh</cmd>
                    <wait>
                      <time>${container.timeout}</time>
                      <exit>0</exit>
                    </wait>
                  </run>
                </image>
                <!--
                -->

                <!-- -Xquickstart -->
                <image>
                  <name>osgi-deployment-folder-app:17_openj9</name>
                  <alias>benchmark_folder_17_openj9_quickstart</alias>
                  
                  <run>
                    <dependsOn>
                      <container>benchmark_jlink_atomos_compressed_17_openj9</container>
                    </dependsOn>
                    <network>
                      <mode>custom</mode>
                      <name>benchmark_network</name>
                    </network>
                    <env>
                      <BENCHMARK_SERVICE_HOST>${benchmark.alias}</BENCHMARK_SERVICE_HOST>
                      <BENCHMARK_SUFFIX>_OPENJ9_QUICKSTART</BENCHMARK_SUFFIX>
                      <ITERATION_COUNT>${benchmark.iteration_count}</ITERATION_COUNT>
                      <JAVA_OPTS_EXTRA>-Xquickstart</JAVA_OPTS_EXTRA>
                    </env>
                    <cmd>./start_benchmark.sh</cmd>
                    <wait>
                      <time>${container.timeout}</time>
                      <exit>0</exit>
                    </wait>
                  </run>
                </image>
                <image>
                  <name>osgi-deployment-executable-app:17_openj9</name>
                  <alias>benchmark_executable_17_openj9_quickstart</alias>
                  
                  <run>
                    <dependsOn>
                      <container>benchmark_folder_17_openj9_quickstart</container>
                    </dependsOn>
                    <network>
                      <mode>custom</mode>
                      <name>benchmark_network</name>
                    </network>
                    <env>
                      <BENCHMARK_SERVICE_HOST>${benchmark.alias}</BENCHMARK_SERVICE_HOST>
                      <BENCHMARK_SUFFIX>_OPENJ9_QUICKSTART</BENCHMARK_SUFFIX>
                      <ITERATION_COUNT>${benchmark.iteration_count}</ITERATION_COUNT>
                      <JAVA_OPTS_EXTRA>-Xquickstart</JAVA_OPTS_EXTRA>
                    </env>
                    <cmd>./start_benchmark.sh</cmd>
                    <wait>
                      <time>${container.timeout}</time>
                      <exit>0</exit>
                    </wait>
                  </run>
                </image>
                <image>
                  <name>osgi-deployment-jlink-app:17_openj9</name>
                  <alias>benchmark_jlink_17_quickstart</alias>
                  
                  <run>
                    <dependsOn>
                      <container>benchmark_executable_17_openj9_quickstart</container>
                    </dependsOn>
                    <network>
                      <mode>custom</mode>
                      <name>benchmark_network</name>
                    </network>
                    <env>
                      <BENCHMARK_SERVICE_HOST>${benchmark.alias}</BENCHMARK_SERVICE_HOST>
                      <BENCHMARK_SUFFIX>_OPENJ9_QUICKSTART</BENCHMARK_SUFFIX>
                      <ITERATION_COUNT>${benchmark.iteration_count}</ITERATION_COUNT>
                      <JAVA_OPTS_EXTRA>-Xquickstart</JAVA_OPTS_EXTRA>
                    </env>
                    <cmd>/app/bin/start_benchmark.sh</cmd>
                    <wait>
                      <time>${container.timeout}</time>
                      <exit>0</exit>
                    </wait>
                  </run>
                </image>
                <image>
                  <name>osgi-deployment-jlink-compressed-app:17_openj9</name>
                  <alias>benchmark_jlink_compressed_17_openj9_quickstart</alias>
                  
                  <run>
                    <dependsOn>
                      <container>benchmark_jlink_17_openj9_quickstart</container>
                    </dependsOn>
                    <network>
                      <mode>custom</mode>
                      <name>benchmark_network</name>
                    </network>
                    <env>
                      <BENCHMARK_SERVICE_HOST>${benchmark.alias}</BENCHMARK_SERVICE_HOST>
                      <BENCHMARK_SUFFIX>_OPENJ9_QUICKSTART</BENCHMARK_SUFFIX>
                      <ITERATION_COUNT>${benchmark.iteration_count}</ITERATION_COUNT>
                      <JAVA_OPTS_EXTRA>-Xquickstart</JAVA_OPTS_EXTRA>
                    </env>
                    <cmd>/app/bin/start_benchmark.sh</cmd>
                    <wait>
                      <time>${container.timeout}</time>
                      <exit>0</exit>
                    </wait>
                  </run>
                </image>
                <image>
                  <name>osgi-deployment-folder-atomos-app:17_openj9</name>
                  <alias>benchmark_folder_atomos_17_openj9_quickstart</alias>
                  
                  <run>
                    <dependsOn>
                      <container>benchmark_jlink_compressed_17_openj9_quickstart</container>
                    </dependsOn>
                    <network>
                      <mode>custom</mode>
                      <name>benchmark_network</name>
                    </network>
                    <env>
                      <BENCHMARK_SERVICE_HOST>${benchmark.alias}</BENCHMARK_SERVICE_HOST>
                      <BENCHMARK_SUFFIX>_OPENJ9_QUICKSTART</BENCHMARK_SUFFIX>
                      <ITERATION_COUNT>${benchmark.iteration_count}</ITERATION_COUNT>
                      <JAVA_OPTS_EXTRA>-Xquickstart</JAVA_OPTS_EXTRA>
                    </env>
                    <cmd>./start_benchmark.sh</cmd>
                    <wait>
                      <time>${container.timeout}</time>
                      <exit>0</exit>
                    </wait>
                  </run>
                </image>
                <image>
                  <name>osgi-deployment-jlink-atomos-app:17_openj9</name>
                  <alias>benchmark_jlink_atomos_17_openj9_quickstart</alias>
                  
                  <run>
                    <dependsOn>
                      <container>benchmark_folder_atomos_17_openj9_quickstart</container>
                    </dependsOn>
                    <network>
                      <mode>custom</mode>
                      <name>benchmark_network</name>
                    </network>
                    <env>
                      <BENCHMARK_SERVICE_HOST>${benchmark.alias}</BENCHMARK_SERVICE_HOST>
                      <BENCHMARK_SUFFIX>_OPENJ9_QUICKSTART</BENCHMARK_SUFFIX>
                      <ITERATION_COUNT>${benchmark.iteration_count}</ITERATION_COUNT>
                      <JAVA_OPTS_EXTRA>-Xquickstart</JAVA_OPTS_EXTRA>
                    </env>
                    <cmd>/app/bin/start_benchmark.sh</cmd>
                    <wait>
                      <time>${container.timeout}</time>
                      <exit>0</exit>
                    </wait>
                  </run>
                </image>
                <image>
                  <name>osgi-deployment-jlink-atomos-compressed-app:17_openj9</name>
                  <alias>benchmark_jlink_atomos_compressed_17_openj9_quickstart</alias>
                  
                  <run>
                    <dependsOn>
                      <container>benchmark_jlink_atomos_17_openj9_quickstart</container>
                    </dependsOn>
                    <network>
                      <mode>custom</mode>
                      <name>benchmark_network</name>
                    </network>
                    <env>
                      <BENCHMARK_SERVICE_HOST>${benchmark.alias}</BENCHMARK_SERVICE_HOST>
                      <BENCHMARK_SUFFIX>_OPENJ9_QUICKSTART</BENCHMARK_SUFFIX>
                      <ITERATION_COUNT>${benchmark.iteration_count}</ITERATION_COUNT>
                      <JAVA_OPTS_EXTRA>-Xquickstart</JAVA_OPTS_EXTRA>
                    </env>
                    <cmd>/app/bin/start_benchmark.sh</cmd>
                    <wait>
                      <time>${container.timeout}</time>
                      <exit>0</exit>
                    </wait>
                  </run>
                </image>
                <!--
                -->

                <!-- shared class cache -->
                <image>
                  <name>osgi-deployment-folder-app:17_openj9_scc</name>
                  <alias>benchmark_folder_17_openj9_scc</alias>
                  
                  <run>
                    <dependsOn>
                      <container>benchmark_jlink_atomos_compressed_17_openj9_quickstart</container>
                    </dependsOn>
                    <network>
                      <mode>custom</mode>
                      <name>benchmark_network</name>
                    </network>
                    <env>
                      <BENCHMARK_SERVICE_HOST>${benchmark.alias}</BENCHMARK_SERVICE_HOST>
                      <BENCHMARK_SUFFIX>_OPENJ9_SCC</BENCHMARK_SUFFIX>
                      <ITERATION_COUNT>${benchmark.iteration_count}</ITERATION_COUNT>
                    </env>
                    <cmd>./start_benchmark.sh</cmd>
                    <wait>
                      <time>${container.timeout}</time>
                      <exit>0</exit>
                    </wait>
                  </run>
                </image>
                <image>
                  <name>osgi-deployment-executable-app:17_openj9_scc</name>
                  <alias>benchmark_executable_17_openj9_scc</alias>
                  
                  <run>
                    <dependsOn>
                      <container>benchmark_folder_17_openj9_scc</container>
                    </dependsOn>
                    <network>
                      <mode>custom</mode>
                      <name>benchmark_network</name>
                    </network>
                    <env>
                      <BENCHMARK_SERVICE_HOST>${benchmark.alias}</BENCHMARK_SERVICE_HOST>
                      <BENCHMARK_SUFFIX>_OPENJ9_SCC</BENCHMARK_SUFFIX>
                      <ITERATION_COUNT>${benchmark.iteration_count}</ITERATION_COUNT>
                    </env>
                    <cmd>./start_benchmark.sh</cmd>
                    <wait>
                      <time>${container.timeout}</time>
                      <exit>0</exit>
                    </wait>
                  </run>
                </image>
                <image>
                  <name>osgi-deployment-jlink-app:17_openj9_scc</name>
                  <alias>benchmark_jlink_17_scc</alias>
                  
                  <run>
                    <dependsOn>
                      <container>benchmark_executable_17_openj9_scc</container>
                    </dependsOn>
                    <network>
                      <mode>custom</mode>
                      <name>benchmark_network</name>
                    </network>
                    <env>
                      <BENCHMARK_SERVICE_HOST>${benchmark.alias}</BENCHMARK_SERVICE_HOST>
                      <BENCHMARK_SUFFIX>_OPENJ9_SCC</BENCHMARK_SUFFIX>
                      <ITERATION_COUNT>${benchmark.iteration_count}</ITERATION_COUNT>
                    </env>
                    <cmd>/app/bin/start_benchmark.sh</cmd>
                    <wait>
                      <time>${container.timeout}</time>
                      <exit>0</exit>
                    </wait>
                  </run>
                </image>
                <image>
                  <name>osgi-deployment-jlink-compressed-app:17_openj9_scc</name>
                  <alias>benchmark_jlink_compressed_17_openj9_scc</alias>
                  
                  <run>
                    <dependsOn>
                      <container>benchmark_jlink_17_openj9_scc</container>
                    </dependsOn>
                    <network>
                      <mode>custom</mode>
                      <name>benchmark_network</name>
                    </network>
                    <env>
                      <BENCHMARK_SERVICE_HOST>${benchmark.alias}</BENCHMARK_SERVICE_HOST>
                      <BENCHMARK_SUFFIX>_OPENJ9_SCC</BENCHMARK_SUFFIX>
                      <ITERATION_COUNT>${benchmark.iteration_count}</ITERATION_COUNT>
                    </env>
                    <cmd>/app/bin/start_benchmark.sh</cmd>
                    <wait>
                      <time>${container.timeout}</time>
                      <exit>0</exit>
                    </wait>
                  </run>
                </image>
                <image>
                  <name>osgi-deployment-folder-atomos-app:17_openj9_scc</name>
                  <alias>benchmark_folder_atomos_17_openj9_scc</alias>
                  
                  <run>
                    <dependsOn>
                      <container>benchmark_jlink_compressed_17_openj9_scc</container>
                    </dependsOn>
                    <network>
                      <mode>custom</mode>
                      <name>benchmark_network</name>
                    </network>
                    <env>
                      <BENCHMARK_SERVICE_HOST>${benchmark.alias}</BENCHMARK_SERVICE_HOST>
                      <BENCHMARK_SUFFIX>_OPENJ9_SCC</BENCHMARK_SUFFIX>
                      <ITERATION_COUNT>${benchmark.iteration_count}</ITERATION_COUNT>
                    </env>
                    <cmd>./start_benchmark.sh</cmd>
                    <wait>
                      <time>${container.timeout}</time>
                      <exit>0</exit>
                    </wait>
                  </run>
                </image>
                <image>
                  <name>osgi-deployment-jlink-atomos-app:17_openj9_scc</name>
                  <alias>benchmark_jlink_atomos_17_openj9_scc</alias>
                  
                  <run>
                    <dependsOn>
                      <container>benchmark_folder_atomos_17_openj9_scc</container>
                    </dependsOn>
                    <network>
                      <mode>custom</mode>
                      <name>benchmark_network</name>
                    </network>
                    <env>
                      <BENCHMARK_SERVICE_HOST>${benchmark.alias}</BENCHMARK_SERVICE_HOST>
                      <BENCHMARK_SUFFIX>_OPENJ9_SCC</BENCHMARK_SUFFIX>
                      <ITERATION_COUNT>${benchmark.iteration_count}</ITERATION_COUNT>
                    </env>
                    <cmd>/app/bin/start_benchmark.sh</cmd>
                    <wait>
                      <time>${container.timeout}</time>
                      <exit>0</exit>
                    </wait>
                  </run>
                </image>
                <image>
                  <name>osgi-deployment-jlink-atomos-compressed-app:17_openj9_scc</name>
                  <alias>benchmark_jlink_atomos_compressed_17_openj9_scc</alias>
                  
                  <run>
                    <dependsOn>
                      <container>benchmark_jlink_atomos_17_openj9_scc</container>
                    </dependsOn>
                    <network>
                      <mode>custom</mode>
                      <name>benchmark_network</name>
                    </network>
                    <env>
                      <BENCHMARK_SERVICE_HOST>${benchmark.alias}</BENCHMARK_SERVICE_HOST>
                      <BENCHMARK_SUFFIX>_OPENJ9_SCC</BENCHMARK_SUFFIX>
                      <ITERATION_COUNT>${benchmark.iteration_count}</ITERATION_COUNT>
                    </env>
                    <cmd>/app/bin/start_benchmark.sh</cmd>
                    <wait>
                      <time>${container.timeout}</time>
                      <exit>0</exit>
                    </wait>
                  </run>
                </image>

                    <!-- <log><color>cyan</color></log> -->

              </images>
            </configuration>
          </plugin>
        </plugins>
      </build>
    </profile>

    <profile>
      <id>criu</id>
      <build>
        <plugins>
          <plugin>
            <groupId>org.codehaus.mojo</groupId>
            <artifactId>exec-maven-plugin</artifactId>
            <version>3.1.1</version>
            <executions>
              <execution>
                <id>run_executable_criu_container</id>
                <phase>integration-test</phase>
                <goals>
                  <goal>exec</goal>
                </goals>
                <configuration>
                  <executable>bash</executable>
                  <workingDirectory>${project.basedir}</workingDirectory>
                  <commandlineArgs>start_benchmark_${benchmark.container.engine}.sh -executable ${benchmark.iteration_count} skip_benchmark_service</commandlineArgs>
                </configuration>
              </execution>
              <execution>
                <id>run_folder_based_criu_container</id>
                <phase>integration-test</phase>
                <goals>
                  <goal>exec</goal>
                </goals>
                <configuration>
                  <executable>bash</executable>
                  <workingDirectory>${project.basedir}</workingDirectory>
                  <commandlineArgs>start_benchmark_${benchmark.container.engine}.sh -folder ${benchmark.iteration_count} skip_benchmark_service</commandlineArgs>
                </configuration>
              </execution>
            </executions>
          </plugin>

          <!-- 
            Starting the containers for benchmarking only works with a single iteration inside the container.
            Trying to start the application via restore multiple times fails because of changed or new files from the previous call.
           -->
          <!--
          <plugin>
            <groupId>io.fabric8</groupId>
            <artifactId>docker-maven-plugin</artifactId>
            <extensions>true</extensions>
            <configuration>
              <images combine.children="append">
                <image>
                  <name>osgi-deployment-folder-criu:latest</name>
                  <alias>benchmark_criu_folder</alias>
                  
                  <run>
                    <log><color>cyan</color></log>
                    <dependsOn>
                      <container>${benchmark.alias}</container>
                    </dependsOn>
                    <network>
                      <mode>custom</mode>
                      <name>benchmark_network</name>
                    </network>
                    <env>
                      <BENCHMARK_SERVICE_HOST>${benchmark.alias}</BENCHMARK_SERVICE_HOST>
                      <BENCHMARK_SUFFIX>_OPENJ9_CRIU</BENCHMARK_SUFFIX>
                      <ITERATION_COUNT>1</ITERATION_COUNT>
                    </env>
                    <capDrop>
                      <drop>ALL</drop>
                    </capDrop>
                    <capAdd>
                      <add>CHECKPOINT_RESTORE</add>
                      <add>SYS_PTRACE</add>
                      <add>SETPCAP</add>
                    </capAdd>
                    <securityOpts>
                      <opt>seccomp=unconfined</opt>
                    </securityOpts>
                    <cmd>./start_benchmark.sh</cmd>
                    <wait>
                      <time>${container.timeout}</time>
                      <exit>0</exit>
                    </wait>
                  </run>
                </image>
                <image>
                  <name>osgi-deployment-executable-criu:latest</name>
                  <alias>benchmark_criu_executable</alias>
                  
                  <run>
                    <log><color>cyan</color></log>
                    <dependsOn>
                      <container>benchmark_criu_folder</container>
                    </dependsOn>
                    <network>
                      <mode>custom</mode>
                      <name>benchmark_network</name>
                    </network>
                    <env>
                      <BENCHMARK_SERVICE_HOST>${benchmark.alias}</BENCHMARK_SERVICE_HOST>
                      <BENCHMARK_SUFFIX>_OPENJ9_CRIU</BENCHMARK_SUFFIX>
                      <ITERATION_COUNT>1</ITERATION_COUNT>
                    </env>
                    <capDrop>
                      <drop>ALL</drop>
                    </capDrop>
                    <capAdd>
                      <add>CHECKPOINT_RESTORE</add>
                      <add>SYS_PTRACE</add>
                      <add>SETPCAP</add>
                    </capAdd>
                    <securityOpts>
                      <opt>seccomp=unconfined</opt>
                    </securityOpts>
                    <cmd>./start_benchmark.sh</cmd>
                    <wait>
                      <time>${container.timeout}</time>
                      <exit>0</exit>
                    </wait>
                  </run>
                </image>
              </images>
            </configuration>
          </plugin>
          -->
        </plugins>
      </build>
    </profile>
  </profiles>
</project>